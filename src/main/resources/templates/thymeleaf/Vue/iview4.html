<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>iview页面</title>
    <script th:src="@{/static/js/polyfill.min.js}" type="text/javascript"></script>
    <link th:href="@{/static/js/iview4/styles/iview.css}" rel="stylesheet" type="text/css"/>
</head>
<body>

<div id="app">

    <Checkbox ref="s1">Checkbox</Checkbox>

    <input type="button" @click="i++" value="添加">

    <template>
        <Alert>An info prompt</Alert>
        <Alert type="success">A success prompt</Alert>
        <Alert type="warning">A warning prompt</Alert>
        <Alert type="error">An error prompt</Alert>
    </template>

    <template>
        <i-select v-model="model1" style="width:200px">
            <i-option v-for="item in cityList" :value="item.value" :key="item.value">{{ item.label }}</i-option>
        </i-select>
        {{model1}}
    </template>

    <template>
        <i-table :columns="columns13" :data="data5" border :span-method="handleSpan" ref="table">
            <template slot-scope="{ row, index, column}" slot="date">
                <span>{{index + '_' + column._index}}</span>
                <Checkbox @on-change="isShow($event,row,index,column._index)"
                          :ref="'check_' + index + '_' + column._index">{{ row.date }}
                </Checkbox>
            </template>

            <template slot-scope="{ row, index, column }" slot="name">
                <span>{{index + '_' + column._index}}</span>
                <Checkbox @on-change="isShow($event,row,index,column._index)"
                          :ref="'check_' + index + '_' + column._index">{{ row.name }}
                </Checkbox>
            </template>

            <template slot-scope="{ row, index, column }" slot="age">
                <span>{{index + '_' + column._index}}</span>
                <Checkbox @on-change="isShow($event,row,index,column._index)"
                          :ref="'check_' + index + '_' + column._index">{{ row.age }}
                </Checkbox>
            </template>

            <template slot-scope="{ row, index, column }" slot="address">
                <span>{{index + '_' + column._index}}</span>
                <Checkbox @on-change="isShow($event,row,index,column._index)"
                          :ref="'check_' + index + '_' + column._index">{{ row.address }}
                </Checkbox>
            </template>

        </i-table>
    </template>
</div>

<script th:src="@{/static/lib/vue/axios.min.js}"></script>
<script th:src="@{/static/js/iview4/iview-patch.js}"></script>
<script th:src="@{/static/lib/jquery/jquery-1.9.1.min.js}"></script>
<script th:src="@{/static/js/iview4/vue.min.js}"></script>
<script th:src="@{/static/js/iview4/iview.min.js}"></script>
<script>
    var app = new Vue({
        el: "#app",
        data: {
            i: 0,
            selectData: {},
            keyMap: {
                0: 'date',
                1: 'name',
                2: 'age',
                3: 'address'
            },
            ace: [],
            columns13: [
                {
                    title: 'Date',
                    key: 'date',
                    resizable: true,
                    width: 180,
                    slot: 'date'
                },
                {
                    title: 'Name',
                    key: 'name',
                    resizable: true,
                    width: 180,
                    slot: 'name'
                },
                {
                    title: 'Age',
                    key: 'age',
                    resizable: true,
                    width: 180,
                    slot: 'age'
                },
                {
                    title: 'Address',
                    key: 'address',
                    slot: 'address'
                }
            ],
            data5: [
                {
                    name: 'John Brown',
                    age: 18,
                    address: 'New York No. 1 Lake Park',
                    date: '2016-10-03'
                },
                {
                    name: 'Jim Green',
                    age: 24,
                    address: 'London No. 1 Lake Park',
                    date: '2016-10-01'
                },
                {
                    name: 'Joe Black',
                    age: 30,
                    address: 'Sydney No. 1 Lake Park',
                    date: '2016-10-02'
                },
                {
                    name: 'Jon Snow',
                    age: 26,
                    address: 'Ottawa No. 2 Lake Park',
                    date: '2016-10-04'
                }
            ],
            cityList: [
                {
                    value: 'New York',
                    label: 'New York'
                },
                {
                    value: 'London',
                    label: 'London'
                },
                {
                    value: 'Sydney',
                    label: 'Sydney'
                },
                {
                    value: 'Ottawa',
                    label: 'Ottawa'
                },
                {
                    value: 'Paris',
                    label: 'Paris'
                },
                {
                    value: 'Canberra',
                    label: 'Canberra'
                }
            ],
            model1: ''
        },
        created() {
            let that = this;


            for (var i = 0; i < that.data5.length; i++) {
                for (var j = 0; j < that.columns13.length; j++) {
                    that.ace.push(i + '_' + j);
                }
            }
        },
        watch: {
            /*selectData: {
                handler(newName, oldName) {
                    console.log(JSON.stringify(newName));
                    debugger
                    //console.log(this.$refs['check_' + newName]);
                    //app.$refs['check_0_2'].disabled = true;
                    //console.log(JSON.stringify(newName));
                },
                immediate: true,
                deep: true
            },*/
            i: function (newValue) {
                console.log(newValue);
            }
        },
        methods: {
            isShow(event, row, rowindex, columnindex) {
                var key = rowindex + '_' + columnindex;
                let ace = this.ace;

                if (event) {
                    app.selectData[key] = row[app.keyMap[columnindex]];

                    let zb = [];


                } else {
                    if (app.selectData.hasOwnProperty(key)) {
                        delete app.selectData[key];
                    }
                }
                console.log(JSON.stringify(app.selectData));


                /*let refKey ='check_' + rowindex+1 + '_' + columnindex;
                app.$refs[refKey].disabled = true;*/
            },
            initAll: function () {
                this.$Message.info('This is a info tip');
            },
            axiosGet: function () {

                axios.get("/axios/test", {params: {id: 12}}).then(function (res) {
                    console.log(res);
                });

            },
            axiosPost: function () {
                var data = {
                    username: '林世权',
                    password: '123456'
                };

                axios.post('/axios/test', data).then(function (res) {
                    console.log(res)
                });

            },
            axiosPut: function () {
                axios.put()
            },
            axiosDelete: function () {
                var data = {
                    username: '林世权',
                    password: '123456'
                };

                let instance = axios.create({
                    headers: {
                        token: 'hvfbsdbvakjhsdkfbksdbfkjbsd'
                    }
                });
                instance.interceptors.request.use(config => {
                    this.$Spin.show({
                        render: (h) => {
                            return h('div', [
                                h('Icon', {
                                    'class': 'demo-spin-icon-load',
                                    props: {
                                        type: 'ios-loading',
                                        size: 18
                                    }
                                }),
                                h('div', 'Loading')
                            ])
                        }
                    });
                    return config;
                });
                instance.interceptors.response.use(res => {
                    this.$Spin.hide();
                    return res;
                });


                instance.delete('/axios/test', {
                    data: data,
                    params: {id: 12}
                }).then(function (res) {
                    console.log(res)
                }).catch(err => {
                    console.log(err);
                });
            },
            axiosCongigure: function () {
                //axios配置
                axios.create({
                    baseURL: 'http://localhost:8080', //请求的域名，基本地址
                    timeout: 1000,                    //请求的超时时长
                    url: '',                          //请求路径
                    method: 'get,post,put,patch,delete', //请求方法
                    headers: {
                        token: ''
                    },                       //请求头
                    params: {},      //拼接到url后面
                    data: {}         //json-data
                });

            },
            ljq: function () {
                //拦截器：在请求或响应被处理前拦截他们

                //1.请求拦截器
                let ss = axios.interceptors.request.use(
                    function (config) {
                        //在发送请求前做些什么，成功后执行then
                        return config;
                    },
                    function (err) {
                        //在请求错误时做些什么,比如404等等
                        return Promise.reject(err);
                    }
                )

                //2.响应拦截器
                axios.interceptors.response.use(
                    function (res) {
                        //请求成功对响应数据做处理
                        return res;
                    },
                    function (err) {
                        //在响应错误时做些什么
                        return Promise.reject(err);
                    }
                )

                //3.取消拦截器
                axios.interceptors.request.eject(ss);

                //1.axios全局配置
                axios.defaults.timeout = 1000;
                axios.defaults.baseURI = 'baidi.com';
                //2.axios实例配置
                let instance = axios.create();
                instance.defaults.timeout = 3000;
                //3.axios请求配置
                instance.get('/data.json', {timeout: 5000})

            },
            // handleSpan: function (row, column, rowIndex, columnIndex) {
            //
            //     if (row.row._index === 0 && row.column._index === 0) {
            //         return [1, 2];
            //     } else if (row.row._index === 0 && row.column._index === 1) {
            //         return [0, 0];
            //     }
            //
            // }
            handleSpan({row, column, rowIndex, columnIndex}) {
                if (row.mergeCol && row.mergeRow) {
                    console.log(JSON.stringify(column))
                    // console.log(JSON.stringify(row));
                    /*return {
                        rowspan: row.mergeCol === 0 ? 0:row.mergeCol,
                        colspan: row.mergeCol === 0 ? 0:1
                    };*/
                }
                /*if (rowIndex === 0 && columnIndex === 0) {
                    return [1, 2];
                } else if (rowIndex === 0 && columnIndex === 1) {
                    return [0, 0];
                }
                if (rowIndex === 2 && columnIndex === 0) {
                    return {
                        rowspan: 2,
                        colspan: 1
                    };
                } else if (rowIndex === 3 && columnIndex === 0) {
                    return {
                        rowspan: 0,
                        colspan: 0
                    };
                }*/
            }
        }
    });

    $(function () {
        //app.initAll();
        //app.axiosGet();
        //app.axiosPost();
        app.axiosDelete();
        //app.$refs['check_0_1'].disabled = true;
        //app.$refs['s1'].disabled = false;
    })
</script>
<style>
    .demo-spin-icon-load{
        animation: ani-demo-spin 1s linear infinite;
    }
</style>
</body>
</html>